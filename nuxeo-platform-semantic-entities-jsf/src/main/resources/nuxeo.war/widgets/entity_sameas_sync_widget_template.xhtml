<span xmlns:f="http://java.sun.com/jsf/core"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:nxu="http://nuxeo.org/nxweb/util"
  xmlns:rich="http://richfaces.org/rich"
  xmlns:a4j="http://richfaces.org/a4j"
  class="sameAsSync">
  
  <a4j:outputPanel id="remoteEntitySuggestionPanel">
  
  <nxu:dataTable id="sameAsTable"
    value="#{currentEntitySameAs}"
    var="remoteEntity"
    rendered="#{not empty currentEntitySameAs">
    <nxu:column>
      <h:outputLink value="#{remoteEntity.uri}">
        <h:graphicImage id="icon" url="/icons/tag_blue.png"/>
      </h:outputLink>
    </nxu:column>
    <nxu:column>
      <h:outputLink value="#{remoteEntity.uri}">
        <h:outputText value="#{remoteEntity.label}"/>
      </h:outputLink>
    </nxu:column>
    <nxu:column>
      <h:commandLink id="syncWithSameAsLink" action="#{semanticEntitiesActions.syncSameAs(remoteEntity.uri)}"
        rendered="#{documentManager.hasPermission(currentDocument.ref, 'WRITE_PROPERTIES')}">
        <h:graphicImage value="/img/refresh.png" />
      </h:commandLink>
    </nxu:column>
    <nxu:column>
      <a4j:commandLink id="removeSameAsLink"
        immediate="true"
        reRender="remoteEntitySuggestionPanel"
        action="#{semanticEntitiesActions.removeSameAsLink(remoteEntity.uri)}"
        rendered="#{documentManager.hasPermission(currentDocument.ref, 'WRITE_PROPERTIES')}">
        <h:graphicImage value="/icons/action_delete_mini.gif" />
      </a4j:commandLink>
    </nxu:column>
  </nxu:dataTable>
  
  <a4j:commandLink id="addSameAsLink"
    ajaxSingle="true" actionListener="#{semanticEntitiesActions.showSuggestRemoteEntitySearch}"
    reRender="remoteEntitySuggestionPanel">
    <h:graphicImage id="toggle_plus" url="/icons/action_add.gif" />
    <h:outputText value="#{messages['command.entity.addSameAs']} "/>
  </a4j:commandLink>
  
  <rich:suggestionbox
    rendered="semanticEntitiesActions.showSuggestRemoteEntitySearch"
    suggestionAction="#{semanticEntitiesActions.suggestRemoteEntity}"
    var="entitySuggestion" for="remoteEntitySuggestionKeywords"
    nothingLabel="${messages['label.results.noMatchingEntity']}"
    ajaxSingle="true">
    <a4j:support event="onselect" reRender="documentViewPanel"
      action="#{semanticEntitiesActions.addRemoteEntityLinkAndSync}"
      ajaxSingle="true">
      <f:setPropertyActionListener value="#{entitySuggestion.uri}"
       target="#{semanticEntitiesActions.selectedEntitySuggestionUri}" />
      <f:setPropertyActionListener value="#{entitySuggestion.label}"
       target="#{semanticEntitiesActions.selectedEntitySuggestionLabel}" />
    </a4j:support>
    <h:column>
      <h:outputText value="#{entitySuggestion.label}" />
    </h:column>
  </rich:suggestionbox>
  
  </a4j:outputPanel>

</span>
